<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <title>Enciclopédia JoJo</title>
    <link rel="stylesheet" href="style.css">
    <script src="global.js" defer></script>
</head>
<body>
    <header>
        <h1>Enciclopédia JJBA - Stands</h1>
        <nav>
            <a href="index.html">Início</a>
            <a href="characters.html">Personagens</a>
            <!-- <a href="battles.html">Batalhas</a> -->
            <a href="parts.html">Partes</a>
        </nav>
    </header>

    <main>
        <section>
            <h2 style="text-align: center;">Lista de Stands</h2>
            <div id="lista-stands"></div>
        </section>
    </main>

    <script>
        async function carregarListaStands() {
            const divLista = document.getElementById('lista-stands');
            try {
                //1. Busca a lista de nomes de stands da nova API
                const response = await fetch('/api/stands');
                const stands = await response.json();
                let letraAtual = ''; //Para controlar o agrupamento A, B, C...

                //2. Itera sobre cada Stand retornado
                stands.forEach(stand => {
                    const primeiraLetra = stand.nome[0].toUpperCase();

                    //3. Se é uma letra nova, cria o cabeçalho
                    if (primeiraLetra !== letraAtual) {
                        letraAtual = primeiraLetra;

                        //Adiciona um separador (exceto antes da letra 'A')
                        if (divLista.children.length > 0) {
                            divLista.appendChild(document.createElement('hr'));
                        }

                        const headerLetra = document.createElement('h2');
                        headerLetra.textContent = letraAtual;
                        divLista.appendChild(headerLetra);
                    }

                    //4. Cria o link para a página de detalhe
                    const link = document.createElement('a');
                    link.textContent = stand.nome;
                    link.className = 'link-stand';

                    //Passa o nome do stand como um "parâmetro de URL"
                    link.href = 'stand-detail.html?nome=' + encodeURIComponent(stand.nome);

                    divLista.appendChild(link);
                });

            } catch (error) {
                console.error('Falha ao carregar Stands:', error);
                divLista.textContent = 'Erro ao carregar lista de Stands.';
            }
        }

        //Inicia a função quando a página carregar
        window.onload = carregarListaStands;
    </script>

    <footer>
        <p>Projeto desenvolvido pelos alunos João Bastasini, Julia Amadio e Thiago Uliame para a disciplina de Bancos de Dados II.</p>
    </footer>
</body>
</html>